
# è®°å½•ä¸€ä¸‹é…ç½®Clashé€æ˜ä»£ç†

2023-8-7|2023-8-10

18118

![å€¾æ—‹](assets/1698904435-939ae2f4723696449cd5e64c1262b048.jpeg)

å€¾æ—‹

ğŸ˜€

æˆ‘æ—¥å¸¸ä½¿ç”¨Arch Linuxæ¥è¿›è¡ŒåŠå…¬ï¼Œä½†å…¬å¸çš„åŠå…¬ç½‘ç»œå’Œä¸Šç½‘éœ€è¦æŒ‚ä¸åŒçš„ä»£ç†ï¼Œæµè§ˆå™¨åˆ‡æ¢èµ·æ¥æœ‰ç‚¹éº»çƒ¦ï¼Œæˆ‘éœ€è¦ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ”¯æŒé…ç½®è§„åˆ™çš„æ–¹å¼æ¥è®©æˆ‘ç³»ç»Ÿä¸Šçš„æµé‡è¿›è¡Œé€‰æ‹©æ€§çš„è½¬å‘ï¼Œæˆ‘å‘ç°Clash+iptablesï¼ˆLinuxç”¨æˆ·ç‹¬æœ‰çš„ç¦åˆ©ï¼‰å¯ä»¥éå¸¸ç®€å•çš„åšåˆ°ã€‚

## 

[â†“â†“â†“](#57f19022c0ab4373b9e5f21c46f73ec6 "ğŸ“Clashæ˜¯ä»€ä¹ˆï¼Ÿ")  
  
  
  
[â†‘â†‘â†‘](#57f19022c0ab4373b9e5f21c46f73ec6 "ğŸ“Clashæ˜¯ä»€ä¹ˆï¼Ÿ")

ğŸ“Clashæ˜¯ä»€ä¹ˆï¼Ÿ

[â†“â†“â†“](https://github.com/Dreamacro/clash)  
  

clash

Dreamacro â€¢ Updated Invalid Date NaN, NaN

  
  
[â†‘â†‘â†‘](https://github.com/Dreamacro/clash)

Clashæ˜¯ä¸€ä¸ªæ”¯æŒå¤šç§åè®®éš§é“è½¬å‘çš„å·¥å…·ï¼Œä¸»è¦åŠŸèƒ½å¦‚ä¸‹ï¼š

-   Inbound: HTTP, HTTPS, SOCKS5 server, TUN device

-   Outbound: Shadowsocks(R), VMess, Trojan, Snell, SOCKS5, HTTP(S), Wireguard

-   Rule-based Routing: dynamic scripting, domain, IP addresses, process name and more

-   Fake-IP DNS: minimises impact on DNS pollution and improves network performance

-   Transparent Proxy: Redirect TCP and TProxy TCP/UDP with automatic route table/rule management

-   Proxy Groups: automatic fallback, load balancing or latency testing

-   Remote Providers: load remote proxy lists dynamically

-   RESTful API: update configuration in-place via a comprehensive API

ç›®å‰ä½œè€…è¿˜åœ¨ç»´æŠ¤[é«˜çº§æ ¸å¿ƒç‰ˆ](https://dreamacro.github.io/clash/premium/introduction.html)ï¼ˆå…è´¹ï¼‰ï¼Œä¸ºäº†å°è¯•æ”¯æŒæ›´å¤šåŠŸèƒ½ã€‚

## 

[â†“â†“â†“](#3717066287dc4c839e499d6ab986ab96 "ğŸª¢å…³äºé€æ˜ä»£ç†")  
  
  
  
[â†‘â†‘â†‘](#3717066287dc4c839e499d6ab986ab96 "ğŸª¢å…³äºé€æ˜ä»£ç†")

ğŸª¢å…³äºé€æ˜ä»£ç†

è¿™é‡Œå¯ä»¥å‚è€ƒä¹‹å‰å†™è¿‡çš„ä¸€ç¯‡ä»‹ç»ï¼š

[â†“â†“â†“](https://payloads.online/article/93929c47-1f25-419b-96d8-7c8f396c036a)  
  

Linuxé€æ˜ä»£ç†åœ¨çº¢é˜Ÿæ¸—é€ä¸­çš„åº”ç”¨ | å€¾æ—‹çš„åšå®¢

æœ¬ç¯‡æ–‡ç« ï¼Œä¸»è¦æ˜¯è®°å½•å·¥ä½œä¸­æƒ³è®©å¤–ç½‘æ‰“ç‚¹å’Œå†…ç½‘æ¸—é€çš„åœºæ™¯è¿›è¡Œé€æ˜ä»£ç†çš„ä½“éªŒã€‚

![Linuxé€æ˜ä»£ç†åœ¨çº¢é˜Ÿæ¸—é€ä¸­çš„åº”ç”¨ | å€¾æ—‹çš„åšå®¢](assets/1698904435-0d6bd705b6208fadb9dae6bf9743745c.ico)

https://payloads.online/article/93929c47-1f25-419b-96d8-7c8f396c036a

![Linuxé€æ˜ä»£ç†åœ¨çº¢é˜Ÿæ¸—é€ä¸­çš„åº”ç”¨ | å€¾æ—‹çš„åšå®¢](assets/1698904435-9d422b5559b8fe528996a4caff3b18f3.png)

  
  
[â†‘â†‘â†‘](https://payloads.online/article/93929c47-1f25-419b-96d8-7c8f396c036a)

## 

[â†“â†“â†“](#9ddeca2f52b64351ac9ba497deecd2e7 "é…ç½®ClashæœåŠ¡")  
  
  
  
[â†‘â†‘â†‘](#9ddeca2f52b64351ac9ba497deecd2e7 "é…ç½®ClashæœåŠ¡")

é…ç½®ClashæœåŠ¡

è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯éœ€è¦è®¾ç½®redir-portï¼Œè¿™ä¸ªé€‰é¡¹: *Linux å’Œ macOS çš„é€æ˜ä»£ç†æœåŠ¡ç«¯å£ (TCP å’Œ TProxy UDP é‡å®šå‘)*

```yaml
port: 7890
socks-port: 7891
allow-lan: true
redir-port: 7892
mode: Rule
log-level: info
external-controller: 127.0.0.1:9090
experimental:
  interface-name: enp34s0 # your interface-name
dns:
  enable: true
  listen: 127.0.0.1:53
  nameserver:
    - 223.5.5.5
  fallback:
    - 'tls://1.1.1.1:853'
    - 'tcp://1.1.1.1'
    - 'tcp://208.67.222.222:443'
    - 'tls://dns.google'
```

YAML

Copy

é™¤æ­¤ä¹‹å¤–ï¼Œæœ€å¥½ç¼–å†™ä¸€ä¸ªæœåŠ¡æ–‡ä»¶ï¼Œå°†Clashè¿è¡Œåœ¨å…¶ä»–ç”¨æˆ·èº«ä»½ä¸‹ï¼š

```plain
[Unit]
Description=clash daemon

[Service]
Type=simple
StandardError=journal
User=clash
Group=clash
CapabilityBoundingSet=CAP_NET_BIND_SERVICE CAP_NET_ADMIN
AmbientCapabilities=CAP_NET_BIND_SERVICE CAP_NET_ADMIN
ExecStart=/usr/bin/clash -d /home/arch/.config/clash
Restart=on-failure

[Install]
WantedBy=default.target
```

Plain text

Copy

å°†æœåŠ¡æ–‡ä»¶æ‹·è´åˆ°ï¼š/etc/systemd/system/

```plain
$ sudo systemctl daemon-reload # é‡æ–°æ‰«ææœåŠ¡å•å…ƒå˜æ›´
$ sudo systemctl enable clash  # å¼€æœºå¯åŠ¨
$ sudo systemctl start clash   # å¯åŠ¨Clash
```

Plain text

Copy

è®¾ç½®DNSæœåŠ¡å™¨åœ°å€ï¼Œç›´æ¥/etc/resolv.confæ–‡ä»¶å³å¯ï¼š

```plain
# /etc/resolv.conf
nameserver 127.0.0.1
```

Plain text

Copy

## 

[â†“â†“â†“](#085666d1ac7c4d04b7a19b4de48e2ef6 "é…ç½®iptablesè§„åˆ™")  
  
  
  
[â†‘â†‘â†‘](#085666d1ac7c4d04b7a19b4de48e2ef6 "é…ç½®iptablesè§„åˆ™")

é…ç½®iptablesè§„åˆ™

åœ¨iptablesä¸­æœ‰ä¸€ä¸ªowneræ¨¡å—ï¼Œå¯ä»¥è¿‡æ»¤æŒ‡å®šç”¨æˆ·çš„æµé‡ï¼Œå¯¹æˆ‘ä»¬æ¥è¯´åªéœ€è¦å°†clashè¿è¡Œåœ¨ä¸€ä¸ªå•ç‹¬çš„ç”¨æˆ·èº«ä»½ä¸‹ï¼Œå¯¹è¿™ä¸ªç”¨æˆ·çš„æ‰€æœ‰æµé‡æ”¾è¡Œå³å¯ã€‚

![notion image](assets/1698904435-8060c842db6a56a924a6af36f30a9e3d.png)

iptableså‘½ä»¤ï¼š

```plain
# æ·»åŠ è§„åˆ™
sudo iptables -t nat -A OUTPUT -p tcp -m owner ! --uid-owner clash ! -d 127.0.0.1 -j REDIRECT --to-port 7892

# åˆ é™¤è§„åˆ™
sudo iptables -t nat -D OUTPUT -p tcp -m owner ! --uid-owner clash ! -d 127.0.0.1 -j REDIRECT --to-port 7892
```

Plain text

Copy

è¿™ä¸ªå‘½ä»¤çš„æ„æ€æ˜¯å°†æ‰€æœ‰ä¸å±äºç”¨æˆ·IDä¸º"clash"çš„TCPæµé‡é‡å®šå‘åˆ°ç«¯å£7892ã€‚

## 

[â†“â†“â†“](#689d25c6c5da4204a5acab3f697d0264 "é…ç½®Clashè§„åˆ™")  
  
  
  
[â†‘â†‘â†‘](#689d25c6c5da4204a5acab3f697d0264 "é…ç½®Clashè§„åˆ™")

é…ç½®Clashè§„åˆ™

```yaml
proxies:
  - ...server1
  - ...server2
proxy-groups:
  - name: ProxyChian1
    type: select
    proxies:
      - server1
      - DIRECT
- name: ProxyChian2
    type: select
    proxies:
      - DIRECT
	- name: å·¥ä½œç¯å¢ƒ
    type: select
    proxies:
      - server1
rules:
  - DOMAIN-SUFFIX,local,ProxyChian2
  - DOMAIN-SUFFIX,localhost,ProxyChian2
  - DOMAIN-SUFFIX,payloads.online,å·¥ä½œç¯å¢ƒ
  - IP-CIDR,10.100.0.0/16,å·¥ä½œç¯å¢ƒ,no-resolve
  - IP-CIDR,10.33.70.0/24,å·¥ä½œç¯å¢ƒ,no-resolve
  - .....
```

YAML

Copy

é€šè¿‡ruleså¯ä»¥é…ç½®ä¸åŒçš„DNSåŸŸåã€IP-CIDRç›®æ ‡åœ°å€çš„æµé‡è¯¥èµ°åˆ°å“ªä¸ªä»£ç†é“¾ä¸Šï¼Œè¿™é‡Œæˆ‘çš„è§„åˆ™ä»…ä»…åªæ˜¯ç¤ºä¾‹ï¼Œä¸ºäº†è¾¾åˆ°æ›´å¥½çš„ç½‘ç»œä½“éªŒï¼Œè§„åˆ™æ˜¯ä¸Šè¾¾å‡ ç™¾è¡Œçš„ã€‚

![notion image](assets/1698904435-4b95b1689d1d9a520a3d9374c0419974.png)

å¦‚æ­¤ä¸€æ¥ï¼Œå·¥ä½œ/ä¸Šç½‘é—®é¢˜ä¸éœ€è¦åˆ‡æ¢ä»£ç†è§£å†³äº†ã€‚

[æŠ€æœ¯åˆ†äº«](https://payloads.online/category/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB)

[å·¥å…·](https://payloads.online/tag/%E5%B7%A5%E5%85%B7)

[çº¢é˜Ÿè¡ŒåŠ¨å®ˆåˆ™](https://payloads.online/archivers/2023/08/10/0ba7791c-bb0f-42e7-8623-22fe07b59fa8)[ä½¿ç”¨Appveyoræ„å»ºVSé¡¹ç›®-å¿«é€Ÿç¼–è¯‘](https://payloads.online/archivers/2023/07/23/9e329caf-052d-4bd9-908b-0ae40a0058bd)

#### [0 ä¸ªè¡¨æƒ…](https://github.com/Rvn0xsy/rvn0xsy.github.io/discussions/22)

[ç™»å½•](https://giscus.app/api/oauth/authorize?redirect_uri=https%3A%2F%2Fpayloads.online%2Farchivers%2F2023%2F08%2F07%2F74116aab-0b33-4644-a6cc-28de0b36214d)åå¯æ·»åŠ å›åº”ã€‚

ğŸ‘ğŸ‘ğŸ˜„ğŸ‰ğŸ˜•â¤ï¸ğŸš€ğŸ‘€

#### [5 æ¡è¯„è®º](https://github.com/Rvn0xsy/rvn0xsy.github.io/discussions/22)

#### Â·

#### 1 æ¡å›å¤

*â€“ ç”± [giscus](https://giscus.app/) æä¾›æ”¯æŒ*

-   æœ€æ—©
-   æœ€æ–°

[![@heheda123123](assets/1698904435-277c81e910719387b0d6331f5c987c1a.jpg)heheda123123](https://github.com/heheda123123)[8 æœˆ 11 æ—¥](https://github.com/Rvn0xsy/rvn0xsy.github.io/discussions/22#discussioncomment-6697443)

v2rayaä¸éœ€è¦ä»»ä½•é…ç½®å°±æ”¯æŒé€æ˜ä»£ç†

1

[ç™»å½•](https://giscus.app/api/oauth/authorize?redirect_uri=https%3A%2F%2Fpayloads.online%2Farchivers%2F2023%2F08%2F07%2F74116aab-0b33-4644-a6cc-28de0b36214d)åå¯æ·»åŠ å›åº”ã€‚

ğŸ‘ğŸ‘ğŸ˜„ğŸ‰ğŸ˜•â¤ï¸ğŸš€ğŸ‘€

1 æ¡å›å¤

[![@Rvn0xsy](assets/1698904435-1387c6435876cba9c65f9fabf9be208c.jpg)](https://github.com/Rvn0xsy)

[Rvn0xsy](https://github.com/Rvn0xsy)[8 æœˆ 11 æ—¥](https://github.com/Rvn0xsy/rvn0xsy.github.io/discussions/22#discussioncomment-6697594)

æ‰€æœ‰è€…

æ£’ï¼

[ç™»å½•](https://giscus.app/api/oauth/authorize?redirect_uri=https%3A%2F%2Fpayloads.online%2Farchivers%2F2023%2F08%2F07%2F74116aab-0b33-4644-a6cc-28de0b36214d)åå¯æ·»åŠ å›åº”ã€‚

ğŸ‘ğŸ‘ğŸ˜„ğŸ‰ğŸ˜•â¤ï¸ğŸš€ğŸ‘€

[![@coutcin-xw](assets/1698904435-245c657c87a8e93fa867151babba2ea5.png)coutcin-xw](https://github.com/coutcin-xw)[8 æœˆ 13 æ—¥](https://github.com/Rvn0xsy/rvn0xsy.github.io/discussions/22#discussioncomment-6713267)

å¸ˆå‚…ï¼Œæˆ‘ç›®å‰ä¹Ÿæ˜¯Archlinuxä½œä¸ºä¸»ç³»ç»Ÿåœ¨ä½¿ç”¨ï¼Œçœ‹æ‚¨ä½¿ç”¨äº†Clashä½œä¸ºä»£ç†è½¯ä»¶ï¼Œä½†æ˜¯å¯¹äºæ—¥å¸¸çš„è®¿é—®googleç­‰éœ€æ±‚ï¼Œçº¯Clashæ¯”è¾ƒéš¾ç”¨ï¼Œä½¿ç”¨clash-for-windowså¯ä»¥å—

1

[ç™»å½•](https://giscus.app/api/oauth/authorize?redirect_uri=https%3A%2F%2Fpayloads.online%2Farchivers%2F2023%2F08%2F07%2F74116aab-0b33-4644-a6cc-28de0b36214d)åå¯æ·»åŠ å›åº”ã€‚

ğŸ‘ğŸ‘ğŸ˜„ğŸ‰ğŸ˜•â¤ï¸ğŸš€ğŸ‘€

0 æ¡å›å¤

[![@Rvn0xsy](assets/1698904435-1387c6435876cba9c65f9fabf9be208c.jpg)Rvn0xsy](https://github.com/Rvn0xsy)[8 æœˆ 13 æ—¥](https://github.com/Rvn0xsy/rvn0xsy.github.io/discussions/22#discussioncomment-6713275)

æ‰€æœ‰è€…

Clash for Windowsä¸å°±æ˜¯åŒ…è£…äº†ä¸€ä¸ªå›¾å½¢ç•Œé¢å—ã€‚ æˆ‘ç›´æ¥é€šè¿‡æµè§ˆå™¨ç®¡ç†Clashçš„ï¼Œä¸€æ ·çš„æ•ˆæœã€‚ ä½ å¯ä»¥åœ¨Githubæœç´¢è¿™ä¸ªé¡¹ç›®ï¼šyacd ï¼Œæˆ–è€… Clash Dashboardï¼Œæ”¯æŒDockeréƒ¨ç½²ã€‚

[â€¦](#)

1

[ç™»å½•](https://giscus.app/api/oauth/authorize?redirect_uri=https%3A%2F%2Fpayloads.online%2Farchivers%2F2023%2F08%2F07%2F74116aab-0b33-4644-a6cc-28de0b36214d)åå¯æ·»åŠ å›åº”ã€‚

ğŸ‘ğŸ‘ğŸ˜„ğŸ‰ğŸ˜•â¤ï¸ğŸš€ğŸ‘€

0 æ¡å›å¤

[![@Dullxxs](assets/1698904435-801e0dc5483150f51b8bf06270685e31.jpg)Dullxxs](https://github.com/Dullxxs)[8 æœˆ 15 æ—¥](https://github.com/Rvn0xsy/rvn0xsy.github.io/discussions/22#discussioncomment-6728159)

è¿™ä¸ä¸Šopenwrt+openclash

1

[ç™»å½•](https://giscus.app/api/oauth/authorize?redirect_uri=https%3A%2F%2Fpayloads.online%2Farchivers%2F2023%2F08%2F07%2F74116aab-0b33-4644-a6cc-28de0b36214d)åå¯æ·»åŠ å›åº”ã€‚

ğŸ‘ğŸ‘ğŸ˜„ğŸ‰ğŸ˜•â¤ï¸ğŸš€ğŸ‘€

0 æ¡å›å¤

[![@Rvn0xsy](assets/1698904435-1387c6435876cba9c65f9fabf9be208c.jpg)Rvn0xsy](https://github.com/Rvn0xsy)[8 æœˆ 15 æ—¥](https://github.com/Rvn0xsy/rvn0xsy.github.io/discussions/22#discussioncomment-6728468)

æ‰€æœ‰è€…

ğŸ˜åœ¨å…¬å¸ä¸Šç­ï¼Œç”¨çš„å°å¼æœºï¼Œå®¶é‡Œå€’æ˜¯å¯ä»¥è¿™ä¹ˆæ•´

[â€¦](#)

1

[ç™»å½•](https://giscus.app/api/oauth/authorize?redirect_uri=https%3A%2F%2Fpayloads.online%2Farchivers%2F2023%2F08%2F07%2F74116aab-0b33-4644-a6cc-28de0b36214d)åå¯æ·»åŠ å›åº”ã€‚

ğŸ‘ğŸ‘ğŸ˜„ğŸ‰ğŸ˜•â¤ï¸ğŸš€ğŸ‘€

0 æ¡å›å¤

è¾“å…¥é¢„è§ˆ

[â†“â†“â†“](https://guides.github.com/features/mastering-markdown/ "æ”¯æŒä½¿ç”¨ Markdown è¯­æ³•")  
  
  
  
[â†‘â†‘â†‘](https://guides.github.com/features/mastering-markdown/ "æ”¯æŒä½¿ç”¨ Markdown è¯­æ³•")

[â†“â†“â†“](https://giscus.app/api/oauth/authorize?redirect_uri=https%3A%2F%2Fpayloads.online%2Farchivers%2F2023%2F08%2F07%2F74116aab-0b33-4644-a6cc-28de0b36214d)  
  
ä½¿ç”¨ GitHub ç™»å½•  
  
[â†‘â†‘â†‘](https://giscus.app/api/oauth/authorize?redirect_uri=https%3A%2F%2Fpayloads.online%2Farchivers%2F2023%2F08%2F07%2F74116aab-0b33-4644-a6cc-28de0b36214d)

0%

[ğŸ“Clashæ˜¯ä»€ä¹ˆï¼Ÿ](#57f19022c0ab4373b9e5f21c46f73ec6)[ğŸª¢å…³äºé€æ˜ä»£ç†](#3717066287dc4c839e499d6ab986ab96)[é…ç½®ClashæœåŠ¡](#9ddeca2f52b64351ac9ba497deecd2e7)[é…ç½®iptablesè§„åˆ™](#085666d1ac7c4d04b7a19b4de48e2ef6)[é…ç½®Clashè§„åˆ™](#689d25c6c5da4204a5acab3f697d0264)
